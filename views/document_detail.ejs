<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>부동산 도우미 - 부동산서식 상세 페이지</title>
  <meta name="description" content="부동산 도우미 웹사이트는 부동산 계약 특약사항 작성에 도움을 드립니다">

  <!-- 브라우저 css 기본스타일 초기화 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reset-css@5.0.2/reset.min.css">
  
	<!-- 제이쿼리 -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
  <!-- css 링크  -->
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/menu.css">
  <link rel="stylesheet" href="../css/document_detail.css">

  <!-- JS 링크 -->
</head>
<body>
	<!-- ===== Header ===== -->
  <header>
    <%- include('menu', {user:user}) %>
  </header>

  <div class="board-name">
    <span>부동산 서식 자료실</span>
  </div>

  <div class="container_input">
    <form action="/document_upload" method="POST" enctype="multipart/form-data">

      <input type="text" id="document_id" value="<%= data[0].id %>" hidden>
      
      <div class="row">
        <label for="title">제목</label>
        <input type="text" id="title" name="title" value="<%= data[0].title %>" disabled> <br>

        <label for="user_name">작성자</label>
        <input type="text" id="user_name" name="user_name" value="<%= data[0].user_name %>" disabled> <br>
      </div>
      
      <div class="container_textarea">
        <label for="content">내용</label>
        <textarea id="content" name="content" rows="10" disabled><%= data[0].content %></textarea> <br>

        <div class="attach">
          <label for="original_name">첨부파일</label>
          <input type="text" id="original_name" name="original_name" 
                value="<%= data[0].original_name %>" onclick="location.href='/uploads/<%= data[0].changed_name %>'"> 
        </div>

        <input type="button" name="list" value="목록" onClick="location.href='/document_list'">

        <% if (user && user.id == data[0].user_id ) { %>
          <input type="button" name="edit" value="수정" onClick="">
          <input type="button" name="delete" value="삭제" onClick="deleteDocument()">
        <% } %>
      </div>

    </form>
  </div>

  <script>
  function deleteDocument() {
    if(confirm("게시글을 삭제하시겠습니까?")) {
      let document_id = document.getElementById("document_id").value;
      $.ajax({
        url : "/document_delete",
        type : "POST",
        data : {document_id:document_id},
        success : function(data) {
          if(data == "게시물삭제성공") {
            alert("게시글을 삭제했습니다")
            window.location.href = '/document_list';
          }
        }
      })
    }
  }
  </script>

</body>

</html>
